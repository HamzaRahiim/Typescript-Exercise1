import{c as fe,r as n,u as je,j as e,S as be}from"./index-3d8791b8.js";import{P as ye}from"./PageBreadcrumb-9dd34a07.js";import{F as we}from"./FormInput-5189d08c.js";import{u as Be}from"./index.esm-f7d27dc8.js";import"./Table-e312cd55.js";import{c as Se,d as Ne}from"./index-e5c69e61.js";import"./httpClient-96fbf256.js";import{S as o}from"./sweetalert2.esm.all-dd0c4ce7.js";import{S as Ce}from"./SingleFileUploader-c9e26641.js";import{C as U}from"./Card-a8049602.js";import{B as m}from"./Button-21cae2d8.js";import{F as h}from"./Form-70877923.js";import{T as Ee}from"./Table-1d1464cf.js";import{B as y}from"./Pagination-ded171f0.js";import{M as w}from"./Modal-9ed1e250.js";import"./Row-10d1c5f5.js";import"./Col-c2024357.js";import"./createWithBsPrefix-36be1bdf.js";import"./InputGroupContext-c86885e2.js";import"./index-2400ada3.js";import"./iconBase-ce8e5803.js";import"./useMergedRefs-ffb77068.js";import"./useCallbackRef-8cbe87ce.js";import"./AbstractModalHeader-14d7211d.js";import"./useWindow-a78371ce.js";import"./NoopTransition-ab7d619d.js";import"./TransitionWrapper-ec82a515.js";import"./DataKey-e12315fd.js";const tt=()=>{var R,G,H;const{isSuperUser:B,permissions:S,user:J}=fe(),$=B||((R=S.Products)==null?void 0:R.Update),K=B||((G=S.Products)==null?void 0:G.Delete),I=B||((H=S.Products)==null?void 0:H.Create),[l,N]=n.useState([]),[M,V]=n.useState(""),[i,L]=n.useState(1),[p,W]=n.useState(15),[C,Y]=n.useState(!0),[q,Q]=n.useState(!1),[x,E]=n.useState(null),[X,f]=n.useState(!1),[Z,v]=n.useState(!1),[k,ee]=n.useState([]),[r,j]=n.useState(null),c="https://backendapi.chase.boundlesstechnologies.net",{token:u}=J,{handleSubmit:te,register:se,control:ae,reset:d,setValue:A,formState:{errors:re}}=Be();n.useEffect(()=>{L(1),Q(l.length>0)},[p,l]);const ne=async()=>{try{if(console.log(" selected Rows ",l),!(await fetch(`${c}/api/brands/bulk-delete`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({ids:l})})).ok)throw new Error("Failed to delete brands");g(),o.fire({title:"Deleted!",text:`All the selected ${l.length} Brands deleted successfully.`,icon:"success",timer:1500})}catch{o.fire("Oops!","Brands deletion failed.","error")}},oe=()=>{o.fire({title:"Are you sure?",text:`All the ${l.length} selected items will be deleted!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&ne()}),console.log("Delete IDs:",l)},le=t=>{t.target.checked?N(k.map(s=>s._id)):N([])},ie=t=>{N(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t])},ce=async t=>{try{if(!(await fetch(`${c}/api/brands/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}})).ok)throw new Error("Failed to delete category");o.fire({title:"Deleted!",text:"Brand deleted successfully.",icon:"success",timer:1500}),g()}catch(s){console.error("Error deleting brands:",s),o.fire({title:"Oops!",text:s.message,icon:"error",timer:1500})}finally{v(!1)}},de=t=>{o.fire({title:"Are you sure?",text:"This Item will be deleted!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Remove!"}).then(s=>{s.isConfirmed&&ce(t)})},me=t=>{V(t.target.value)},he=()=>{Y(!C)},_=k.filter(t=>t.name.toLowerCase().includes(M.toLowerCase())).sort((t,s)=>C?t.name.localeCompare(s.name):s.name.localeCompare(t.name)),D=t=>{L(t)},z=Math.ceil(_.length/p),O=_.slice((i-1)*p,i*p),[b,P]=je(),g=async()=>{try{v(!0);const t=await fetch(`${c}/api/brands`,{method:"GET",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to get subcategories")}const s=await t.json();console.log("data from brands ",s),s&&ee(s)}catch(t){console.error("Error getting brands data :",t)}finally{v(!1)}},pe=async t=>{console.log("Brand Data:",t);const s=new FormData;s.append("name",t.name),x&&s.append("image",x);try{f(!0);const a=await fetch(`${c}/api/brands`,{method:"POST",headers:{Authorization:`Bearer ${u}`},body:s});if(!a.ok){const T=await a.json();throw new Error(T.message||"Failed to add new Brand")}await a.json()&&(o.fire({title:"ADDED!",text:"Brand added successfully!",icon:"success",confirmButtonText:"OK",timer:1500}),g())}catch(a){console.error("Error adding brand:",a),o.fire({title:"Oops!",text:a.message,icon:"error",timer:1500})}finally{f(!1)}};n.useEffect(()=>{g()},[]);const F=()=>{b&&(d({name:""}),E(null),j(null)),P()},ue=t=>{j(t),A("name",t.name),P()},ge=async t=>{console.log("Updating Brand Data:",t);const s=new FormData;s.append("name",t.name),x&&s.append("image",x);try{f(!0);const a=await fetch(`${c}/api/brands/${r==null?void 0:r._id}`,{method:"PUT",headers:{Authorization:`Bearer ${u}`},body:s});if(!a.ok){const T=await a.json();throw new Error(T.message||"Failed to Update Brand")}await a.json()&&(F(),await g(),o.fire({title:"Updated!",text:"Brand updated successfully!",icon:"success",confirmButtonText:"OK",timer:1500}),d(),j(null))}catch(a){console.error("Error Updating Brand:",a),o.fire({title:"Oops!",text:a.message,icon:"error",timer:1500})}finally{f(!1)}};return n.useEffect(()=>{b||(d(),E(null),j(null))},[b,d]),n.useEffect(()=>{r?A("name",r.name):d({name:""})},[r,A,d]),Z?e.jsx(be,{}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{title:"Brands",subName:"Products"}),e.jsxs(U,{children:[e.jsxs(U.Header,{children:[e.jsxs("div",{className:"d-flex flex-column flex-lg-row justify-content-between align-items-lg-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"header-title",children:"Brand Management"}),e.jsx("p",{className:"text-muted mb-0",children:"Add and Manage your all Product brands here."})]}),e.jsxs("div",{className:"mt-3 mt-lg-0",children:[e.jsxs(m,{style:{border:"none"},variant:"success",disabled:!I,onClick:P,children:[e.jsx("i",{className:"bi bi-plus"})," Add New Brand"]}),q&&e.jsx(m,{variant:"danger",className:"ms-2",onClick:oe,children:"Delete All Selected"})]})]}),e.jsxs("div",{className:"d-flex flex-column flex-lg-row justify-content-between align-items-lg-center mt-3",children:[e.jsx("div",{className:"app-search d-none d-lg-block",children:e.jsx("form",{children:e.jsxs("div",{className:"input-group",style:{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"10px",border:"1px solid rgba(0, 0, 0, 0.1)"},children:[e.jsx("input",{type:"search",className:"form-control",placeholder:"Search Brands here...",value:M,onChange:me,style:{backgroundColor:"transparent",border:"none",paddingLeft:"10px",color:"#333"}}),e.jsx("span",{className:"ri-search-line search-icon text-muted",style:{marginRight:"10px",color:"#666"}})]})})}),e.jsxs(h.Select,{value:p,style:{zIndex:1},onChange:t=>W(Number(t.target.value)),className:"w-auto mt-3 mt-lg-0",children:[e.jsx("option",{value:15,children:"15 items"}),e.jsx("option",{value:30,children:"30 items"}),e.jsx("option",{value:40,children:"40 items"})]})]})]}),e.jsx(U.Body,{children:e.jsxs("div",{className:"table-responsive-sm",children:[e.jsxs(Ee,{className:"table-striped table-centered mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{children:[e.jsx("input",{type:"checkbox",onChange:le,checked:l.length===k.length})," "]}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:e.jsxs("span",{onClick:he,style:{cursor:"pointer"},children:["Name ",C?"↑":"↓"]})}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:O.length>0?(O||[]).map((t,s)=>{const a=l.includes(t._id);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:a,onChange:()=>ie(t._id)})}),e.jsx("td",{className:"table-user",children:t!=null&&t.logo?e.jsx("img",{src:`${c}/${t.logo}`,alt:"brands",className:"me-2 rounded-circle"}):""}),e.jsx("td",{children:t.name}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(m,{variant:"secondary",disabled:!$,onClick:()=>ue(t),children:e.jsx(Se,{})}),e.jsx(m,{variant:"danger",className:"ms-2",onClick:()=>de(t._id.toString()),disabled:!K,children:e.jsx(Ne,{})})]})})]},s)}):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center",children:"No records found"})})})]}),e.jsx("nav",{className:"d-flex justify-content-end mt-3",children:e.jsxs(y,{className:"pagination-rounded mb-0",children:[e.jsx(y.Prev,{onClick:()=>i>1&&D(i-1)}),Array.from({length:z},(t,s)=>e.jsx(y.Item,{active:s+1===i,onClick:()=>D(s+1),children:s+1},s+1)),e.jsx(y.Next,{onClick:()=>i<z&&D(i+1)})]})})]})}),e.jsxs(w,{show:b,onHide:F,dialogClassName:"modal-dialog-centered",children:[e.jsx(w.Header,{closeButton:!0,children:e.jsx("h4",{className:"modal-title",children:r?"Update Brand":"Add New Brand"})}),e.jsxs(h,{onSubmit:te(r?ge:pe),children:[e.jsxs(w.Body,{children:[e.jsx(h.Group,{className:"mb-3",children:e.jsx(we,{label:"Name",type:"text",name:"name",containerClass:"mb-3",register:se,placeholder:"Enter Brand Name here..",errors:re,control:ae})}),e.jsxs(h.Group,{className:"mb-2",children:[e.jsx(h.Label,{children:r?"Upload New Image":"Upload Image"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{style:{fontSize:"0.8rem"},className:"text-danger mb-0",children:"File Size: Upload images up to 5 MB."}),e.jsx("p",{style:{fontSize:"0.8rem"},className:"text-danger mb-0",children:"Supported Formats: JPEG (.jpg, .jpeg), PNG (.png), GIF(.gif), WebP (.webp), and SVG (.svg)."}),e.jsx("p",{style:{fontSize:"0.8rem"},className:"text-danger mb-0",children:"Upload Limit: Only 1 image can be uploaded."})]}),e.jsx(Ce,{icon:"ri-upload-cloud-2-line",text:"Drop file here or click to upload a brand image.",onFileUpload:t=>E(t)}),(r==null?void 0:r.logo)&&e.jsxs("div",{className:"mt-3 d-flex flex-column",children:[e.jsx(h.Label,{children:"Current Image"}),e.jsx("img",{src:`${c}/${r.logo}`,alt:"Brand",className:"img-thumbnail mb-3",style:{width:"100px",height:"100px"}})]})]})]}),e.jsxs(w.Footer,{children:[e.jsx(m,{variant:"light",onClick:F,children:"Close"}),e.jsx(m,{variant:"soft-success",type:"submit",disabled:r?!$:!I,children:X?r?"Updating...":"Adding...":r?"Update Brand":"Save Brand"})]})]})]})]})]})};export{tt as default};
