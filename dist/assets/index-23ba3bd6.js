import{r as a,d as j,c as y,j as e,N as S,L}from"./index-3d8791b8.js";import{o as E,c as A,a as f}from"./index.esm-229abc95.js";import{A as P}from"./AuthLayout-6c7a5ff8.js";import"./httpClient-96fbf256.js";import{S as k}from"./sweetalert2.esm.all-dd0c4ce7.js";import{P as N}from"./PageBreadcrumb-9dd34a07.js";import{F as p}from"./FormInput-5189d08c.js";import{V as v}from"./VerticalForm-205d4ba2.js";import"./Table-e312cd55.js";import{B}from"./Button-21cae2d8.js";import"./index.esm-f7d27dc8.js";import"./auth-img-4538a299.js";import"./logo-92e11ba8.js";import"./Row-10d1c5f5.js";import"./Col-c2024357.js";import"./Card-a8049602.js";import"./createWithBsPrefix-36be1bdf.js";import"./Image-8a789d10.js";import"./index-2400ada3.js";import"./Form-70877923.js";import"./InputGroupContext-c86885e2.js";function C(){const[l,o]=a.useState(!1),[c,n]=a.useState(null),[t,m]=a.useState(!1),s=j(),{isAuthenticated:g,saveSession:h}=y(),x=a.useMemo(()=>s.state&&s.state.from?s.state.from.pathname:"/",[s.state]);return{loading:l,login:async({email:b,password:w})=>{n(null),o(!0);try{const d=await fetch("https://backendapi.chase.boundlesstechnologies.net/api/auth/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b,password:w})});if(!d.ok){const i=await d.json();throw new Error(i.message||"Login failed")}const r=await d.json();if(r.token){m(!0),console.log(" before sace session ");const i={is_superuser:r.user.is_superuser??null,permissions:r.user.role.permissions??null,token:r.token??null,username:r.user.username??null,role:r.user.role.role_name??null};return console.log(" data saving in local before in uselogin page",i),h(i),{success:!0,message:"Login successful"}}return{success:!1,message:"Login failed"}}catch(u){return n(u.message),{success:!1,message:u.message}}finally{o(!1)}},redirectUrl:x,isAuthenticated:g,error:c,success:t}}const F=E(A().shape({email:f().required("Please enter Username"),password:f().required("Please enter Password")})),se=()=>{const{loading:l,login:o,redirectUrl:c,isAuthenticated:n,error:t}=C(),m=async s=>{await o(s)};return a.useEffect(()=>{t&&k.fire({icon:"error",title:"Login Failed",text:t,showConfirmButton:!1,timer:1500})},[t]),e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Log In"}),n&&e.jsx(S,{to:c,replace:!0}),e.jsx(P,{authTitle:"Sign In",helpText:"Enter your email address and password to access account.",hasThirdPartyLogin:!0,children:e.jsxs(v,{onSubmit:m,resolver:F,defaultValues:{email:"admin@admin.com",password:"Admin123?"},children:[e.jsx(p,{label:"Email address",type:"text",name:"email",placeholder:"Enter your email",containerClass:"mb-3",required:!0}),e.jsx(p,{label:"Password",name:"password",type:"password",required:!0,id:"password",placeholder:"Enter your password",containerClass:"mb-3",children:e.jsx(L,{to:"/auth/forgot-password",className:"text-muted float-end",children:e.jsx("small",{children:"Forgot your password?"})})}),e.jsx(p,{label:"Remember me",type:"checkbox",name:"checkbox",containerClass:"mb-3"}),e.jsx("div",{className:"mb-0 text-start",children:e.jsxs(B,{variant:"soft-success",className:"w-100",type:"submit",disabled:l,children:[e.jsx("i",{className:"ri-login-circle-fill me-1"}),e.jsx("span",{className:"fw-bold",children:"Log In"})]})})]})})]})};export{se as default};
