import{r as i,c as V,j as e,L as v,i as E}from"./index-3d8791b8.js";import{P as A}from"./PageBreadcrumb-9dd34a07.js";import{F as B}from"./FormInput-5189d08c.js";import"./Table-e312cd55.js";import"./httpClient-96fbf256.js";import{S as w}from"./sweetalert2.esm.all-dd0c4ce7.js";import{C as d}from"./Card-a8049602.js";import{B as g}from"./Button-21cae2d8.js";import{R as F}from"./Row-10d1c5f5.js";import{C as L}from"./Col-c2024357.js";import{T as _}from"./Table-1d1464cf.js";import{F as n}from"./Form-70877923.js";import"./createWithBsPrefix-36be1bdf.js";import"./InputGroupContext-c86885e2.js";import"./index-2400ada3.js";const Z=()=>{var y,k;const h={Products:{Create:!1,View:!1,Update:!1,Delete:!1},Orders:{Create:!1,View:!1,Update:!1,Delete:!1},Shippings:{Create:!1,View:!1,Update:!1,Delete:!1},Users:{Create:!1,View:!1,Update:!1,Delete:!1},Inventory:{Create:!1,View:!1,Update:!1,Delete:!1},Policies:{Create:!1,View:!1,Update:!1,Delete:!1},Settings:{Create:!1,View:!1,Update:!1,Delete:!1},Customers:{Create:!1,View:!1,Update:!1,Delete:!1}},[t,m]=i.useState(h),{user:S,isSuperUser:f,permissions:x}=V(),[j,p]=i.useState(""),[c,u]=i.useState(""),[C,b]=i.useState(!1),R=()=>{m(h),u("")},U=f||((y=x.Users)==null?void 0:y.View),N=f||((k=x.Users)==null?void 0:k.Create),r=(s,a)=>{m(l=>({...l,[s]:{...l[s],[a]:!l[s][a]}}))},D=async()=>{if(!c){p("Please Enter a Role Name.");return}p(""),b(!0);const s={role_name:c,permissions:t};console.log(s);try{const a=S.token,o=await fetch("https://backendapi.chase.boundlesstechnologies.net/api/users/role",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(s)});if(!o.ok){const P=await o.json();throw new Error(P.message||"Registration failed")}o.ok&&(await o.json(),w.fire({title:"Role Created Successfully!",text:"Role with permission has been created successfully!",icon:"success",timer:1500}),R())}catch{w.fire({title:"Error!",text:"This Role is already taken. Please choose another one.",icon:"error",timer:1500})}finally{b(!1)}};return e.jsxs("div",{children:[e.jsx(A,{title:"Create New Role",subName:"User"}),e.jsxs(d,{children:[e.jsx(d.Header,{children:e.jsxs("div",{className:"d-flex flex-column flex-lg-row justify-content-between align-items-lg-center",children:[e.jsx("div",{children:e.jsx("h4",{className:"header-title",children:"Role & Permission"})}),e.jsxs("div",{className:"mt-3 mt-lg-0",children:[" ",e.jsx(g,{style:{border:"none"},variant:"none",disabled:!U,children:e.jsx(v,{to:"/user/role-all",className:"btn btn-danger",children:"See All Roles"})})]})]})}),e.jsxs(d.Body,{children:[e.jsx(F,{children:e.jsxs(L,{lg:6,className:"mb-3",children:[e.jsx(B,{label:"Role",type:"text",name:"role_name",placeholder:"Enter Role Name",containerClass:"",value:c,onChange:s=>u(s.target.value)},"role_name"),j&&e.jsx("small",{className:"text-danger",children:j})]})}),e.jsx("div",{className:"table-responsive-sm",children:e.jsxs(_,{className:"table-hover table-centered mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Page"}),e.jsx("th",{children:"View"}),e.jsx("th",{children:"Create"}),e.jsx("th",{children:"Update"}),e.jsx("th",{children:"Delete"})]})}),e.jsx("tbody",{children:Object.keys(t).map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s}),e.jsx("td",{children:e.jsx(n.Check,{type:"checkbox",style:{margin:"0 auto",display:"block"},checked:t[s].View,onChange:()=>r(s,"View")})}),e.jsx("td",{children:e.jsx(n.Check,{type:"checkbox",style:{margin:"0 auto",display:"block"},checked:t[s].Create,onChange:()=>r(s,"Create")})}),e.jsx("td",{children:e.jsx(n.Check,{type:"checkbox",style:{margin:"0 auto",display:"block"},checked:t[s].Update,onChange:()=>r(s,"Update")})}),e.jsx("td",{children:e.jsx(n.Check,{type:"checkbox",style:{margin:"0 auto",display:"block"},checked:t[s].Delete,onChange:()=>r(s,"Delete")})})]},s))})]})}),e.jsx(g,{className:"mt-3",variant:"success",onClick:D,disabled:C||!N,children:C?e.jsx(E,{}):"Save Role & Permission"})]})]})]})};export{Z as default};
