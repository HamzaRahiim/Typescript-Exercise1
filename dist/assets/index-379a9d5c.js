import{r as x,j as e,L as P}from"./index-3d8791b8.js";import{A as y}from"./AuthLayout-6c7a5ff8.js";import{o as j,c as b,a as C}from"./index.esm-229abc95.js";import{P as E}from"./PageBreadcrumb-9dd34a07.js";import{F as T}from"./FormInput-5189d08c.js";import{V as B}from"./VerticalForm-205d4ba2.js";import"./Table-e312cd55.js";import{S as s}from"./sweetalert2.esm.all-dd0c4ce7.js";import{B as k}from"./Button-21cae2d8.js";import{R as N}from"./Row-10d1c5f5.js";import{C as O}from"./Col-c2024357.js";import"./auth-img-4538a299.js";import"./logo-92e11ba8.js";import"./Card-a8049602.js";import"./createWithBsPrefix-36be1bdf.js";import"./Image-8a789d10.js";import"./index-2400ada3.js";import"./index.esm-f7d27dc8.js";import"./Form-70877923.js";import"./InputGroupContext-c86885e2.js";const m=()=>e.jsx(N,{children:e.jsx(O,{xs:12,className:"text-center",children:e.jsxs("p",{className:"text-dark-emphasis",children:["Back To"," ",e.jsx(P,{to:"/auth/login",className:"text-dark fw-bold ms-1 link-offset-3 text-decoration-underline",children:e.jsx("b",{children:"Log In"})})]})})}),Q=()=>{const p=j(b().shape({email:C().email("Please enter a valid email").required("Please enter email")})),[u,n]=x.useState(!1),f=async w=>{const{email:h}=w;n(!0);try{const r="https://backendapi.chase.boundlesstechnologies.net",a=await fetch(`${r}/api/auth/user/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h})});if(!a.ok){const t=await a.json();console.log("error get ",t.message);const o=t.message||"Failed to send Email.";s.fire({icon:"error",title:"Error",text:o});return}a.ok&&s.fire({title:"Reset Password With OTP",html:`
					<p>OTP is being sent to your email. Please enter it below:</p>
					<input id="otp" class="swal2-input" type="text" placeholder="Enter OTP">
					<input id="newPassword" class="swal2-input" type="password" placeholder="Enter New Password">
					<input id="confirmPassword" class="swal2-input" type="password" placeholder="Confirm New Password">
				  `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Reset Password",showLoaderOnConfirm:!0,preConfirm:async()=>{const t=document.getElementById("otp").value,o=document.getElementById("newPassword").value,l=document.getElementById("confirmPassword").value;if(!t||!o||!l){s.showValidationMessage("All fields are required.");return}if(o!==l){s.showValidationMessage("Passwords do not match.");return}try{const c=`${r}/api/auth/user/reset-password`,d=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otpCode:t,newPassword:o})}),i=await d.json();if(!d.ok){console.log("Error in response:",i);const g=i.message||"Failed to reset password";return s.showValidationMessage(g)}return i}catch{s.showValidationMessage("Request failed: Please try again later.")}},allowOutsideClick:()=>!s.isLoading()}).then(t=>{t.isConfirmed&&s.fire({title:"Password Reset Successfully",icon:"success",showCancelButton:!0,confirmButtonText:"Login",cancelButtonText:"Cancel"}).then(o=>{o.isConfirmed&&(window.location.href="/auth/login")})}),console.log("sucess",a)}catch(r){console.log("error",r),s.fire({icon:"error",title:"Error",text:"Request Failed. Please try again later."});return}finally{n(!1)}};return e.jsxs("div",{children:[e.jsx(E,{title:"Forgot Password"}),e.jsx(y,{authTitle:"Forgot Password?",helpText:"Enter your email address and we'll send you an OTP to reset your password.",bottomLinks:e.jsx(m,{}),children:e.jsxs(B,{onSubmit:f,resolver:p,children:[e.jsx(T,{label:"Email address",type:"email",name:"email",placeholder:"Enter your email",containerClass:"mb-3",required:!0}),e.jsx("div",{className:"mb-0 text-start",children:e.jsxs(k,{variant:"soft-success",className:"w-100",type:"submit",disabled:u,children:[e.jsx("i",{className:"ri-loop-left-line me-1 fw-bold"})," ",e.jsx("span",{className:"fw-bold",children:"Send OTP"})," "]})})]})}),e.jsx(m,{})]})};export{Q as default};
